<!DOCTYPE html>
<html lang="sv">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="theme-color" content="#1a1a2e">
    <meta name="description" content="V√§derprognos fr√•n flera sources kombinerade till en ensemble-prognos">
    <link rel="manifest" href="manifest.json">
    <link rel="apple-touch-icon" href="icons/icon.svg">
    <title>V√§derensemble</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Instrument+Sans:wght@400;500;600;700&family=Playfair+Display:wght@600&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css">
    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
    <style>
        :root{--bg-deep:#0f0f1a;--bg-card:#1a1a2e;--bg-card-hover:#252542;--text-primary:#f0f0f5;--text-secondary:#8888a0;--text-muted:#555570;--accent-warm:#ff6b4a;--accent-cool:#4a9eff;--accent-sun:#ffd93d;--accent-rain:#6bcfff;--confidence-high:#4ade80;--confidence-medium:#fbbf24;--confidence-low:#f87171;--gradient-sky:linear-gradient(135deg,#667eea 0%,#764ba2 100%);--shadow-soft:0 4px 20px rgba(0,0,0,0.3);--shadow-glow:0 0 40px rgba(102,126,234,0.15);--radius-sm:8px;--radius-md:16px;--radius-lg:24px;--radius-xl:32px}*{margin:0;padding:0;box-sizing:border-box}body{font-family:'Instrument Sans',-apple-system,sans-serif;background:var(--bg-deep);color:var(--text-primary);min-height:100vh;line-height:1.6}.atmosphere{position:fixed;top:0;left:0;right:0;bottom:0;pointer-events:none;z-index:0}.atmosphere::before{content:'';position:absolute;top:-50%;left:-50%;width:200%;height:200%;background:radial-gradient(ellipse at 20% 20%,rgba(102,126,234,0.08) 0%,transparent 50%),radial-gradient(ellipse at 80% 80%,rgba(118,75,162,0.08) 0%,transparent 50%);animation:drift 30s ease-in-out infinite}@keyframes drift{0%,100%{transform:translate(0,0)}33%{transform:translate(2%,1%)}66%{transform:translate(-1%,2%)}}.grain{position:fixed;top:0;left:0;right:0;bottom:0;pointer-events:none;z-index:1000;opacity:0.03}.container{position:relative;z-index:1;max-width:1200px;margin:0 auto;padding:24px;min-height:100vh}header{text-align:center;padding:40px 0 60px}.logo{font-family:'Playfair Display',serif;font-size:clamp(2.5rem,8vw,4rem);font-weight:600;background:linear-gradient(135deg,var(--text-primary) 0%,var(--text-secondary) 100%);-webkit-background-clip:text;-webkit-text-fill-color:transparent;background-clip:text;margin-bottom:8px}.tagline{color:var(--text-secondary);font-size:1rem;letter-spacing:0.1em;text-transform:uppercase}.search-section{max-width:500px;margin:0 auto 48px}.search-wrapper{position:relative;display:flex;gap:12px}.search-input{flex:1;padding:16px 24px;font-size:1rem;font-family:inherit;background:var(--bg-card);border:1px solid transparent;border-radius:var(--radius-xl);color:var(--text-primary);outline:none;transition:all 0.3s}.search-input::placeholder{color:var(--text-muted)}.search-input:focus{border-color:rgba(102,126,234,0.5);box-shadow:var(--shadow-glow)}.search-btn{padding:16px 28px;font-size:1rem;font-family:inherit;font-weight:600;background:var(--gradient-sky);border:none;border-radius:var(--radius-xl);color:white;cursor:pointer;transition:all 0.3s}.search-btn:hover{transform:translateY(-2px);box-shadow:0 8px 30px rgba(102,126,234,0.4)}.geolocate-btn{position:absolute;right:140px;top:50%;transform:translateY(-50%);padding:8px;background:transparent;border:none;color:var(--text-secondary);cursor:pointer;border-radius:50%;transition:all 0.2s;display:none}.geolocate-btn:hover{color:var(--accent-cool);background:rgba(74,158,255,0.1)}.loading-overlay{display:none;position:fixed;top:0;left:0;right:0;bottom:0;background:rgba(15,15,26,0.9);z-index:100;align-items:center;justify-content:center;flex-direction:column;gap:24px}.loading-overlay.active{display:flex}.loader{width:60px;height:60px;border:3px solid var(--bg-card);border-top-color:var(--accent-cool);border-radius:50%;animation:spin 1s linear infinite}@keyframes spin{to{transform:rotate(360deg)}}.loading-text{color:var(--text-secondary)}.weather-display{display:none;animation:fadeIn 0.5s}.weather-display.active{display:block}@keyframes fadeIn{from{opacity:0;transform:translateY(20px)}to{opacity:1;transform:translateY(0)}}.location-header{text-align:center;margin-bottom:48px}.location-name{font-family:'Playfair Display',serif;font-size:clamp(1.8rem,5vw,2.5rem);font-weight:600;margin-bottom:4px}.location-coords{color:var(--text-muted);font-size:0.875rem}.current-weather{background:var(--bg-card);border-radius:var(--radius-xl);padding:48px;margin-bottom:32px;position:relative;overflow:hidden;box-shadow:var(--shadow-soft)}.current-weather::before{content:'';position:absolute;top:0;left:0;right:0;height:4px;background:var(--gradient-sky)}.current-main{display:flex;align-items:center;justify-content:space-between;flex-wrap:wrap;gap:32px}.current-temp-section{display:flex;align-items:flex-start;gap:24px}.weather-icon{font-size:5rem;line-height:1;filter:drop-shadow(0 4px 20px rgba(255,217,61,0.3))}.current-temp{font-size:clamp(4rem,15vw,7rem);font-weight:700;line-height:1;letter-spacing:-0.03em}.temp-unit{font-size:0.4em;font-weight:400;color:var(--text-secondary);vertical-align:super}.current-details{display:flex;flex-direction:column;gap:8px;min-width:200px}.current-description{font-size:1.25rem;text-transform:capitalize}.current-meta{display:flex;gap:24px;color:var(--text-secondary);font-size:0.95rem}.meta-item{display:flex;align-items:center;gap:6px}.confidence-section{margin-top:32px;padding-top:32px;border-top:1px solid rgba(255,255,255,0.05)}.confidence-header{display:flex;align-items:center;justify-content:space-between;margin-bottom:16px}.confidence-label{font-size:0.875rem;color:var(--text-secondary);text-transform:uppercase;letter-spacing:0.1em}.confidence-value{font-size:1rem;font-weight:600}.confidence-bar{height:8px;background:var(--bg-deep);border-radius:4px;overflow:hidden}.confidence-fill{height:100%;border-radius:4px;transition:width 0.5s,background 0.3s}.confidence-high{background:var(--confidence-high)}.confidence-medium{background:var(--confidence-medium)}.confidence-low{background:var(--confidence-low)}.sources-section{background:var(--bg-card);border-radius:var(--radius-xl);margin-bottom:32px;overflow:hidden}.sources-section .section-title{margin-bottom:0;padding:24px 32px;cursor:pointer;display:flex;justify-content:space-between;align-items:center;transition:background 0.2s}.sources-section .section-title:hover{background:var(--bg-card-hover)}.sources-section.open .section-title{margin-bottom:0}.toggle-icon{font-size:0.8rem;transition:transform 0.3s}.sources-section.open .toggle-icon{transform:rotate(180deg)}.sources-content{max-height:0;overflow:hidden;transition:max-height 0.4s ease-out;padding:0 32px}.sources-section.open .sources-content{max-height:800px;padding:0 32px 32px}@media(max-width:768px){.sources-section .section-title{padding:20px 24px}.sources-content{padding:0 24px}.sources-section.open .sources-content{max-height:1200px;padding:0 24px 24px}.sources-grid{grid-template-columns:1fr}}.sources-grid{display:grid;grid-template-columns:repeat(auto-fit,minmax(200px,1fr));gap:16px}.source-card{background:var(--bg-deep);border-radius:var(--radius-md);padding:20px;text-align:center}.source-name{font-size:0.75rem;font-weight:600;color:var(--text-muted);text-transform:uppercase;letter-spacing:0.1em;margin-bottom:8px}.source-icon{font-size:2.5rem;margin-bottom:8px}.source-temp{font-size:2rem;font-weight:700;margin-bottom:12px}.source-details{font-size:0.85rem;color:var(--text-secondary);line-height:1.8}.source-status{display:inline-block;padding:4px 8px;border-radius:4px;font-size:0.7rem;font-weight:600;text-transform:uppercase;margin-top:12px}.status-ok{background:rgba(74,222,128,0.2);color:var(--confidence-high)}.status-error{background:rgba(248,113,113,0.2);color:var(--confidence-low)}.hourly-section{background:var(--bg-card);border-radius:var(--radius-xl);padding:32px;margin-bottom:32px;overflow:hidden}.hourly-scroll{display:flex;gap:8px;overflow-x:auto;padding-bottom:16px;scrollbar-width:thin;scrollbar-color:var(--bg-card-hover) transparent}.hourly-scroll::-webkit-scrollbar{height:6px}.hourly-scroll::-webkit-scrollbar-thumb{background:var(--bg-card-hover);border-radius:3px}.hourly-item{flex:0 0 auto;width:72px;padding:16px 12px;background:var(--bg-deep);border-radius:var(--radius-md);text-align:center;transition:all 0.2s}.hourly-item:hover{background:var(--bg-card-hover)}.hourly-time{font-size:0.75rem;color:var(--text-muted);margin-bottom:8px}.hourly-icon{font-size:1.5rem;margin-bottom:8px}.hourly-temp{font-size:1.1rem;font-weight:600}.hourly-precip{font-size:0.7rem;color:var(--accent-rain);margin-top:4px}.daily-section{background:var(--bg-card);border-radius:var(--radius-xl);padding:32px}.daily-list{display:flex;flex-direction:column;gap:8px}.daily-item{display:grid;grid-template-columns:60px 40px 1fr 130px;align-items:center;gap:12px;padding:16px;background:var(--bg-deep);border-radius:var(--radius-md);transition:all 0.2s}.daily-item:hover{background:var(--bg-card-hover)}.daily-day{font-weight:500}.daily-icon{font-size:1.5rem;text-align:center}.daily-temp-range{display:flex;align-items:center;gap:12px}.temp-bar-container{flex:1;height:6px;background:var(--bg-card);border-radius:3px;position:relative;max-width:120px}.temp-bar{position:absolute;height:100%;background:linear-gradient(90deg,var(--accent-cool),var(--accent-warm));border-radius:3px}.daily-temps{display:flex;gap:8px}.temp-high{font-weight:600}.temp-low{color:var(--text-secondary)}.daily-confidence{text-align:right;display:flex;align-items:center;justify-content:flex-end;gap:6px;white-space:nowrap}.confidence-dot{display:inline-block;width:8px;height:8px;border-radius:50%;flex-shrink:0}.daily-confidence-text{font-size:0.8rem;color:var(--text-secondary);font-variant-numeric:tabular-nums}.empty-state{text-align:center;padding:80px 20px}.empty-icon{font-size:4rem;margin-bottom:24px;opacity:0.5}.empty-text{color:var(--text-secondary);font-size:1.1rem;max-width:400px;margin:0 auto}.error-message{background:rgba(248,113,113,0.1);border:1px solid rgba(248,113,113,0.3);border-radius:var(--radius-md);padding:16px 24px;color:var(--confidence-low);text-align:center;margin-bottom:24px;display:none}.error-message.active{display:block;animation:shake 0.5s}@keyframes shake{0%,100%{transform:translateX(0)}25%{transform:translateX(-5px)}75%{transform:translateX(5px)}}@media(max-width:768px){.container{padding:16px}.current-weather{padding:32px 24px}.current-main{flex-direction:column;text-align:center}.current-temp-section{flex-direction:column;align-items:center}.current-details{align-items:center}.daily-item{grid-template-columns:80px 40px 1fr;gap:12px}.daily-confidence{display:none}.search-wrapper{flex-direction:column}.geolocate-btn{position:static;transform:none;width:100%;padding:12px;background:var(--bg-card);border-radius:var(--radius-lg);order:-1}}.install-prompt{display:none;position:fixed;bottom:24px;left:24px;right:24px;max-width:400px;margin:0 auto;background:var(--bg-card);border-radius:var(--radius-lg);padding:20px;box-shadow:var(--shadow-soft);z-index:50}.install-prompt.active{display:block;animation:slideUp 0.3s}@keyframes slideUp{from{transform:translateY(100%);opacity:0}to{transform:translateY(0);opacity:1}}.install-content{display:flex;align-items:center;gap:16px}.install-icon{font-size:2rem}.install-text{flex:1}.install-title{font-weight:600;margin-bottom:4px}.install-desc{font-size:0.875rem;color:var(--text-secondary)}.install-actions{display:flex;gap:8px;margin-top:16px}.install-btn{flex:1;padding:12px;border:none;border-radius:var(--radius-sm);font-family:inherit;font-weight:600;cursor:pointer}.install-btn-primary{background:var(--gradient-sky);color:white}.install-btn-secondary{background:var(--bg-deep);color:var(--text-secondary)}.offline-indicator{display:none;position:fixed;top:16px;left:50%;transform:translateX(-50%);background:var(--confidence-low);color:white;padding:8px 16px;border-radius:var(--radius-sm);font-size:0.875rem;z-index:100}.offline-indicator.active{display:block}.search-suggestions{display:none;position:absolute;top:100%;left:0;right:0;margin-top:8px;background:var(--bg-card);border-radius:var(--radius-md);box-shadow:var(--shadow-soft);z-index:50;max-height:300px;overflow-y:auto}.search-suggestions.active{display:block}.suggestion-item{padding:14px 20px;cursor:pointer;border-bottom:1px solid rgba(255,255,255,0.05);transition:background 0.2s}.suggestion-item:last-child{border-bottom:none}.suggestion-item:hover,.suggestion-item.selected{background:var(--bg-card-hover)}.suggestion-name{font-weight:500;margin-bottom:2px}.suggestion-region{font-size:0.85rem;color:var(--text-secondary)}.day-detail-modal{display:none;position:fixed;top:0;left:0;right:0;bottom:0;background:rgba(15,15,26,0.95);z-index:200;align-items:center;justify-content:center;padding:20px}.day-detail-modal.active{display:flex}.day-detail-content{background:var(--bg-card);border-radius:var(--radius-xl);max-width:600px;width:100%;max-height:90vh;overflow-y:auto;animation:fadeIn 0.3s}.day-detail-header{display:flex;justify-content:space-between;align-items:center;padding:24px;border-bottom:1px solid rgba(255,255,255,0.05)}.day-detail-header h3{font-family:'Playfair Display',serif;font-size:1.5rem}.day-detail-close{background:none;border:none;color:var(--text-secondary);font-size:1.5rem;cursor:pointer;padding:8px;transition:color 0.2s}.day-detail-close:hover{color:var(--text-primary)}.day-detail-summary{display:grid;grid-template-columns:repeat(2,1fr);gap:16px;padding:24px}.day-detail-stat{background:var(--bg-deep);border-radius:var(--radius-md);padding:16px;text-align:center}.day-detail-stat-label{font-size:0.75rem;color:var(--text-muted);text-transform:uppercase;margin-bottom:8px}.day-detail-stat-value{font-size:1.25rem;font-weight:600}.day-detail-hourly{padding:0 24px 24px}.day-detail-hourly-title{font-size:0.875rem;color:var(--text-secondary);text-transform:uppercase;margin-bottom:16px}.day-detail-hourly-grid{display:grid;grid-template-columns:repeat(auto-fill,minmax(70px,1fr));gap:8px}.day-detail-hour{background:var(--bg-deep);border-radius:var(--radius-sm);padding:12px 8px;text-align:center}.day-detail-hour-time{font-size:0.75rem;color:var(--text-muted);margin-bottom:4px}.day-detail-hour-icon{font-size:1.25rem;margin-bottom:4px}.day-detail-hour-temp{font-weight:600;margin-bottom:4px}.day-detail-hour-detail{font-size:0.7rem;color:var(--text-secondary)}.recent-location{margin-top:16px;display:flex;align-items:center;justify-content:center;gap:8px}.recent-label{color:var(--text-muted);font-size:0.875rem}.recent-btn{background:var(--bg-card);border:1px solid rgba(255,255,255,0.1);border-radius:var(--radius-lg);padding:10px 20px;color:var(--text-primary);font-family:inherit;font-size:0.95rem;cursor:pointer;transition:all 0.2s}.recent-btn:hover{background:var(--bg-card-hover);border-color:rgba(102,126,234,0.5)}.section-title{font-size:1rem;font-weight:600;color:var(--text-secondary);text-transform:uppercase;letter-spacing:0.1em;margin-bottom:24px}.section-hint{font-size:0.7rem;font-weight:400;color:var(--text-muted);margin-left:8px;text-transform:none;letter-spacing:0}.compare-modal{display:none;position:fixed;top:0;left:0;right:0;bottom:0;background:rgba(15,15,26,0.95);z-index:200;align-items:center;justify-content:center;padding:20px}.compare-modal.active{display:flex}.compare-content{background:var(--bg-card);border-radius:var(--radius-xl);max-width:700px;width:100%;max-height:90vh;overflow-y:auto;animation:fadeIn 0.3s}.compare-header{display:flex;justify-content:space-between;align-items:center;padding:24px;border-bottom:1px solid rgba(255,255,255,0.05)}.compare-header h3{font-family:'Playfair Display',serif;font-size:1.5rem}.compare-close{background:none;border:none;color:var(--text-secondary);font-size:1.5rem;cursor:pointer;padding:8px;transition:color 0.2s}.compare-close:hover{color:var(--text-primary)}.compare-body{padding:24px}.compare-cards{display:grid;grid-template-columns:repeat(auto-fit,minmax(140px,1fr));gap:16px}.compare-card{background:var(--bg-deep);border-radius:var(--radius-md);padding:20px;text-align:center}.compare-card-ensemble{background:linear-gradient(135deg,rgba(102,126,234,0.2),rgba(118,75,162,0.2));border:1px solid rgba(102,126,234,0.3)}.compare-card-failed{opacity:0.5}.compare-card-title{font-size:0.8rem;font-weight:600;color:var(--text-muted);text-transform:uppercase;letter-spacing:0.05em;margin-bottom:12px}.compare-card-icon{font-size:2rem;margin-bottom:8px}.compare-card-temp{font-size:2.5rem;font-weight:700;margin-bottom:12px}.compare-card-row{font-size:0.9rem;color:var(--text-secondary);margin-bottom:6px}.compare-card-desc{font-size:0.8rem;color:var(--text-muted);margin-top:8px;text-transform:capitalize}.compare-card-error{color:var(--confidence-low);font-size:0.9rem}.refresh-btn{position:absolute;top:16px;right:16px;background:var(--bg-deep);border:1px solid rgba(255,255,255,0.1);border-radius:50%;width:44px;height:44px;cursor:pointer;transition:all 0.3s;display:flex;align-items:center;justify-content:center;color:var(--text-secondary)}.refresh-btn:hover{background:var(--bg-card-hover);color:var(--accent-cool);transform:rotate(180deg)}.refresh-btn:active{transform:rotate(360deg)}.geolocate-btn{display:flex;position:static;transform:none;align-items:center;justify-content:center;gap:8px;width:100%;padding:14px 20px;margin-bottom:16px;background:var(--gradient-sky);border:none;border-radius:var(--radius-lg);color:white;font-family:inherit;font-size:0.95rem;font-weight:500;cursor:pointer;transition:all 0.2s}.geolocate-btn:hover{transform:translateY(-2px);box-shadow:0 8px 30px rgba(102,126,234,0.4)}.geolocate-btn svg{color:white}.update-banner{display:none;position:fixed;top:16px;left:50%;transform:translateX(-50%);background:var(--gradient-sky);color:white;padding:12px 20px;border-radius:var(--radius-lg);font-size:0.9rem;z-index:150;box-shadow:var(--shadow-soft);cursor:pointer;transition:all 0.2s;align-items:center;gap:10px}.update-banner.active{display:flex}.update-banner:hover{transform:translateX(-50%) translateY(-2px);box-shadow:0 8px 30px rgba(102,126,234,0.4)}.update-banner-text{font-weight:500}.update-banner-btn{background:rgba(255,255,255,0.2);border:none;color:white;padding:6px 12px;border-radius:var(--radius-sm);font-family:inherit;font-weight:600;cursor:pointer;transition:background 0.2s}.update-banner-btn:hover{background:rgba(255,255,255,0.3)}.search-input-wrapper{position:relative;flex:1}.search-input-wrapper .search-input{width:100%;padding-right:40px}.search-clear{position:absolute;right:12px;top:50%;transform:translateY(-50%);background:none;border:none;color:var(--text-muted);font-size:1.1rem;cursor:pointer;padding:4px 8px;border-radius:4px;transition:all 0.2s}.search-clear:hover{color:var(--text-primary);background:rgba(255,255,255,0.1)}.feels-like{font-size:1rem;color:var(--text-secondary);margin-top:4px}.forecast-summary{padding:20px 0;margin-top:24px;border-top:1px solid rgba(255,255,255,0.05);color:var(--text-secondary);font-size:1rem;line-height:1.6}.forecast-text-section{background:var(--bg-card);border-radius:var(--radius-xl);padding:24px 32px;margin-bottom:32px}.forecast-text-content{display:flex;align-items:flex-start;gap:16px}.forecast-text-icon{font-size:1.5rem;flex-shrink:0}.forecast-text{color:var(--text-secondary);font-size:1rem;line-height:1.6;margin:0}.warnings-section{background:var(--bg-card);border-radius:var(--radius-xl);padding:24px 32px;margin-bottom:32px}.warnings-list{display:flex;flex-direction:column;gap:12px}.warning-item{display:flex;align-items:flex-start;gap:12px;padding:16px;border-radius:var(--radius-md);background:var(--bg-deep)}.warning-red{border-left:4px solid #ef4444}.warning-orange{border-left:4px solid #f97316}.warning-yellow{border-left:4px solid #eab308}.warning-green{border-left:4px solid #22c55e}.warning-icon{font-size:1.2rem}.warning-content{flex:1}.warning-headline{font-weight:600;margin-bottom:4px}.warning-area{font-size:0.85rem;color:var(--text-muted)}.air-quality-section{background:var(--bg-card);border-radius:var(--radius-xl);margin-bottom:32px;overflow:hidden}.air-quality-section .section-title{margin-bottom:0;padding:24px 32px;cursor:pointer;display:flex;justify-content:center;align-items:center;gap:16px;position:relative;transition:background 0.2s}.air-quality-section .section-title .toggle-icon{position:absolute;right:32px}.air-quality-section .section-title:hover{background:var(--bg-card-hover)}.air-quality-section.open .toggle-icon{transform:rotate(180deg)}.air-quality-content{max-height:0;overflow:hidden;transition:max-height 0.4s ease-out;padding:0 32px;display:flex;flex-direction:column;gap:16px}.air-quality-section.open .air-quality-content{max-height:500px;padding:0 32px 32px}.aqi-main{text-align:center;padding:16px;background:var(--bg-deep);border-radius:var(--radius-md)}.aqi-value{font-size:3rem;font-weight:700}.aqi-label{font-size:1rem;color:var(--text-secondary);margin-bottom:12px}.aqi-bar{height:8px;background:var(--bg-card);border-radius:4px;overflow:hidden}.aqi-fill{height:100%;border-radius:4px;transition:width 0.5s}.aqi-details{display:flex;justify-content:center;gap:24px;font-size:0.85rem;color:var(--text-muted)}.pollen-section{padding:16px;background:var(--bg-deep);border-radius:var(--radius-md)}.pollen-title{font-size:0.875rem;color:var(--text-secondary);margin-bottom:12px}.pollen-list{display:flex;flex-wrap:wrap;gap:12px}.pollen-item{font-size:0.9rem}.aqi-ensemble{display:flex;align-items:center;justify-content:center;gap:8px;padding:8px 12px;background:var(--bg-deep);border-radius:var(--radius-md);font-size:0.75rem;color:var(--text-muted)}.ensemble-badge{background:linear-gradient(135deg,rgba(102,126,234,0.3),rgba(118,75,162,0.3));padding:4px 10px;border-radius:var(--radius-sm);font-weight:600;color:var(--accent-cool)}.ensemble-sources{opacity:0.8}.ensemble-spread{color:var(--confidence-medium);background:rgba(251,191,36,0.15);padding:2px 6px;border-radius:4px}.aqi-details{display:flex;flex-wrap:wrap;justify-content:center;gap:16px;font-size:0.8rem;color:var(--text-muted);padding:12px;background:var(--bg-deep);border-radius:var(--radius-md)}.aqi-details span{padding:4px 8px;background:rgba(255,255,255,0.05);border-radius:4px}.uv-section{background:var(--bg-card);border-radius:var(--radius-xl);margin-bottom:32px;overflow:hidden}.uv-section .section-title{margin-bottom:0;padding:24px 32px;cursor:pointer;display:flex;justify-content:center;align-items:center;gap:16px;position:relative;transition:background 0.2s}.uv-section .section-title .toggle-icon{position:absolute;right:32px}.uv-section .section-title:hover{background:var(--bg-card-hover)}.uv-section.open .toggle-icon{transform:rotate(180deg)}.uv-content{max-height:0;overflow:hidden;transition:max-height 0.4s ease-out;padding:0 32px;display:flex;flex-direction:column;gap:16px}.uv-section.open .uv-content{max-height:400px;padding:0 32px 32px}.uv-chart-container{position:relative;padding:32px 12px 28px;background:var(--bg-deep);border-radius:var(--radius-md);cursor:crosshair;touch-action:none}.uv-line-chart{width:100%;height:80px;display:block}.uv-point{transition:r 0.15s}.uv-time-labels{position:absolute;bottom:6px;left:12px;right:12px;height:16px}.uv-time-label{position:absolute;transform:translateX(-50%);font-size:0.65rem;color:var(--text-muted)}.uv-tooltip{position:absolute;top:4px;transform:translateX(-50%);display:flex;flex-direction:column;align-items:center;pointer-events:none;z-index:10}.uv-tooltip-value{font-size:0.9rem;font-weight:700}.uv-tooltip-time{font-size:0.65rem;color:var(--text-muted)}.uv-indicator{position:absolute;top:32px;bottom:28px;width:2px;transform:translateX(-50%);opacity:0.6;pointer-events:none;border-radius:1px}.uv-legend{display:flex;flex-wrap:wrap;justify-content:center;gap:6px;padding:8px 12px;background:var(--bg-deep);border-radius:var(--radius-md)}.uv-legend-item{font-size:0.6rem;padding:2px 6px;border-radius:3px;color:white;opacity:0.9}.uv-tip{font-size:0.8rem;color:var(--text-secondary);padding:10px 14px;background:var(--bg-deep);border-radius:var(--radius-md);text-align:center}.nowcast-section{background:var(--bg-card);border-radius:var(--radius-xl);margin-bottom:32px;overflow:hidden}.nowcast-section .section-title{margin-bottom:0;padding:24px 32px;cursor:pointer;display:flex;justify-content:center;align-items:center;gap:16px;position:relative;transition:background 0.2s}.nowcast-section .section-title .toggle-icon{position:absolute;right:32px}.nowcast-section .section-title:hover{background:var(--bg-card-hover)}.nowcast-section.open .toggle-icon{transform:rotate(180deg)}.nowcast-content{max-height:0;overflow:hidden;transition:max-height 0.4s ease-out;padding:0 32px;display:flex;flex-direction:column;gap:16px}.nowcast-section.open .nowcast-content{max-height:600px;padding:0 32px 32px}.nowcast-timeline{position:relative;padding:16px 0;background:var(--bg-deep);border-radius:var(--radius-md)}.nowcast-bars{display:flex;height:60px;align-items:flex-end;padding:0 12px;gap:1px}.nowcast-bar{flex:1;min-width:3px;background:var(--accent-rain);border-radius:2px 2px 0 0;transition:height 0.3s,opacity 0.3s}.nowcast-bar.dry{background:var(--bg-card);opacity:0.3}.nowcast-time-labels{display:flex;justify-content:space-between;padding:8px 12px 0;font-size:0.65rem;color:var(--text-muted)}.nowcast-stats{display:grid;grid-template-columns:repeat(auto-fit,minmax(140px,1fr));gap:12px}.nowcast-stat{background:var(--bg-deep);border-radius:var(--radius-md);padding:16px;text-align:center}.nowcast-stat-label{font-size:0.7rem;color:var(--text-muted);text-transform:uppercase;margin-bottom:6px}.nowcast-stat-value{font-size:1.1rem;font-weight:600}.nowcast-stat-sub{font-size:0.75rem;color:var(--text-secondary);margin-top:4px}.dry-periods{background:var(--bg-deep);border-radius:var(--radius-md);padding:16px}.dry-periods-title{font-size:0.75rem;color:var(--text-muted);text-transform:uppercase;margin-bottom:12px}.dry-period-list{display:flex;flex-direction:column;gap:8px}.dry-period-item{display:flex;align-items:center;gap:12px;padding:10px 14px;background:rgba(74,222,128,0.1);border-radius:var(--radius-sm);border-left:3px solid var(--confidence-high)}.dry-period-icon{font-size:1rem}.dry-period-text{flex:1;font-size:0.9rem}.dry-period-duration{font-size:0.8rem;color:var(--text-muted)}.nowcast-sources{display:flex;align-items:center;justify-content:center;gap:8px;padding:8px 12px;background:var(--bg-deep);border-radius:var(--radius-md);font-size:0.7rem;color:var(--text-muted)}.nowcast-risk-indicator{display:flex;align-items:center;gap:8px;margin-top:8px;padding:8px 14px;background:rgba(255,255,255,0.05);border-radius:var(--radius-md);font-size:0.95rem;animation:riskPulse 2s ease-in-out infinite}.nowcast-risk-indicator .risk-icon{font-size:1.1rem}.nowcast-risk-indicator .risk-text{font-weight:500}.nowcast-risk-indicator .risk-source{font-size:0.7rem;opacity:0.7;margin-left:auto}@keyframes riskPulse{0%,100%{opacity:1}50%{opacity:0.85}}.ocean-wind-indicator{display:flex;align-items:center;gap:8px;margin-top:6px;padding:6px 12px;background:rgba(74,158,255,0.1);border-radius:var(--radius-md);font-size:0.9rem;border-left:3px solid var(--accent-cool)}.ocean-wind-indicator .ocean-icon{font-size:1rem}.ocean-wind-indicator .ocean-text{color:var(--accent-cool);font-weight:500}.ocean-wind-indicator .ocean-dist{font-size:0.75rem;color:var(--text-muted);margin-left:auto}.ocean-source{border:1px solid rgba(74,158,255,0.3);background:linear-gradient(135deg,rgba(74,158,255,0.1),rgba(107,207,255,0.1))}.radar-section{background:var(--bg-card);border-radius:var(--radius-xl);margin-bottom:32px;overflow:hidden}.radar-section .section-title{margin-bottom:0;padding:24px 32px;cursor:pointer;display:flex;justify-content:center;align-items:center;gap:16px;position:relative;transition:background 0.2s}.radar-section .section-title .toggle-icon{position:absolute;right:32px}.radar-section .section-title:hover{background:var(--bg-card-hover)}.radar-section.open .toggle-icon{transform:rotate(180deg)}.radar-content{max-height:0;overflow:hidden;transition:max-height 0.4s ease-out;padding:0 32px;display:flex;flex-direction:column;gap:16px}.radar-section.open .radar-content{max-height:700px;padding:0 32px 32px}.radar-image-container{position:relative;width:100%;border-radius:var(--radius-md);overflow:hidden;background:var(--bg-deep)}.radar-image{width:100%;height:auto;display:block;border-radius:var(--radius-md)}.radar-map-container{position:relative;width:100%;height:350px;border-radius:var(--radius-md);overflow:hidden;background:var(--bg-deep)}.radar-map-container .leaflet-container{background:var(--bg-deep)}.radar-time-display{position:absolute;top:12px;right:12px;background:rgba(0,0,0,0.7);color:white;padding:6px 12px;border-radius:var(--radius-sm);font-size:0.9rem;font-weight:600}.radar-controls{display:flex;align-items:center;gap:16px;padding:12px;background:var(--bg-deep);border-radius:var(--radius-md)}.radar-btn{padding:10px 20px;background:var(--gradient-sky);border:none;border-radius:var(--radius-sm);color:white;font-family:inherit;font-weight:600;cursor:pointer;transition:all 0.2s;white-space:nowrap}.radar-btn:hover{transform:translateY(-1px);box-shadow:0 4px 15px rgba(102,126,234,0.3)}.radar-timeline{flex:1;display:flex;flex-direction:column;gap:8px}.radar-timeline input[type="range"]{width:100%;height:6px;-webkit-appearance:none;background:var(--bg-card);border-radius:3px;cursor:pointer}.radar-timeline input[type="range"]::-webkit-slider-thumb{-webkit-appearance:none;width:16px;height:16px;background:var(--accent-cool);border-radius:50%;cursor:pointer}.radar-time-labels{position:relative;height:16px;font-size:0.65rem;color:var(--text-muted)}.radar-time-labels span{position:absolute;transform:translateX(-50%)}.radar-legend{display:flex;flex-wrap:wrap;justify-content:center;gap:12px;padding:10px;background:var(--bg-deep);border-radius:var(--radius-md)}.radar-legend-item{display:flex;align-items:center;gap:6px;font-size:0.75rem;color:var(--text-secondary)}.radar-color{width:16px;height:10px;border-radius:2px}.radar-info{display:flex;align-items:center;justify-content:center;gap:8px;padding:8px 12px;background:var(--bg-deep);border-radius:var(--radius-md);font-size:0.7rem;color:var(--text-muted)}.radar-position-marker{font-size:20px;text-shadow:0 2px 4px rgba(0,0,0,0.5)}.radar-embed-container{width:100%;height:350px;border-radius:var(--radius-md);overflow:hidden;background:var(--bg-deep)}.radar-iframe{width:100%;height:100%;border:none}.radar-link{color:var(--accent-cool);text-decoration:none;font-size:0.85rem;display:flex;align-items:center;justify-content:center;gap:6px;padding:12px;background:var(--bg-deep);border-radius:var(--radius-md);transition:all 0.2s}.radar-link:hover{background:var(--bg-card-hover)}.radar-links{display:flex;flex-wrap:wrap;gap:8px;justify-content:center}@media(max-width:768px){.current-meta{flex-wrap:wrap;gap:12px}.forecast-text-section{padding:16px 20px}.warnings-section{padding:16px 20px}.air-quality-section .section-title,.uv-section .section-title,.nowcast-section .section-title,.radar-section .section-title{padding:18px 20px;padding-right:44px;font-size:0.8rem;white-space:nowrap;letter-spacing:0.05em}.air-quality-section .section-title .toggle-icon,.uv-section .section-title .toggle-icon,.nowcast-section .section-title .toggle-icon,.radar-section .section-title .toggle-icon{right:16px}.air-quality-content,.uv-content,.nowcast-content,.radar-content{padding:0 20px}.air-quality-section.open .air-quality-content,.uv-section.open .uv-content,.nowcast-section.open .nowcast-content,.radar-section.open .radar-content{padding:0 20px 20px}.aqi-details{flex-wrap:wrap;gap:8px}.nowcast-stats{grid-template-columns:repeat(2,1fr);gap:8px}.nowcast-stat{padding:12px}.hourly-section,.daily-section{padding:24px 20px}.section-title{font-size:0.85rem}.radar-map-container{height:250px}.radar-controls{flex-direction:column}.radar-btn{width:100%}.ocean-wind-indicator{font-size:0.8rem}}
    </style>
</head>
<body>
    <div class="atmosphere"></div>
    <div class="grain"></div>
    <div class="offline-indicator" id="offlineIndicator">Offline - visar cachad data</div>
    <div class="update-banner" id="updateBanner"><span class="update-banner-text">Ny version tillganglig</span><button class="update-banner-btn" id="updateBtn">Uppdatera</button></div>
    <div class="loading-overlay" id="loadingOverlay"><div class="loader"></div><div class="loading-text">Laddar data fr√•n k√§llor</div></div>
    <div class="container">
        <header><h1 class="logo">V√§derensemble</h1><p class="tagline">Kombinerad prognos fr√•n YR ¬∑ SMHI ¬∑ Open-Meteo</p></header>
        <section class="search-section"><button class="geolocate-btn" id="geolocateBtn"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polygon points="3 11 22 2 13 21 11 13 3 11"/></svg>Mitt v√§der</button><div class="search-wrapper"><div class="search-input-wrapper"><input type="text" class="search-input" id="searchInput" placeholder="S√∂k plats (t.ex. G√∂teborg)" autocomplete="off"><button class="search-clear" id="searchClear" type="button" style="display:none">‚úï</button></div><div class="search-suggestions" id="searchSuggestions"></div><button class="search-btn" id="searchBtn">S√∂k</button></div><div class="recent-location" id="recentLocation" style="display:none"><span class="recent-label">Senaste:</span><button class="recent-btn" id="recentBtn">-</button></div></section>
        <div class="error-message" id="errorMessage"></div>
        <div class="empty-state" id="emptyState"><div class="empty-icon">üå§Ô∏è</div><p class="empty-text">S√∂k efter en plats eller anv√§nd din nuvarande position f√∂r att se v√§derprognosen fr√•n flera sources kombinerade.</p></div>
        <div class="weather-display" id="weatherDisplay">
            <div class="location-header"><h2 class="location-name" id="locationName">-</h2><p class="location-coords" id="locationCoords">-</p></div>
            <section class="current-weather"><button class="refresh-btn" id="refreshBtn" title="Uppdatera"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5"><path d="M23 4v6h-6"/><path d="M1 20v-6h6"/><path d="M3.51 9a9 9 0 0 1 14.85-3.36L23 10M1 14l4.64 4.36A9 9 0 0 0 20.49 15"/></svg></button><div class="current-main"><div class="current-temp-section"><div class="weather-icon" id="currentIcon">‚òÄÔ∏è</div><div><div class="current-temp"><span id="currentTemp">--</span><span class="temp-unit">¬∞C</span></div><div class="feels-like" id="currentFeelsLike" style="display:none"></div></div></div><div class="current-details"><div class="current-description" id="currentDescription">-</div><div class="current-meta"><span class="meta-item">üí®<span id="currentWind">- m/s</span></span><span class="meta-item">üí¶<span id="currentHumidity">- %</span></span><span class="meta-item">üåßÔ∏è<span id="currentPrecip">- mm</span></span><span class="meta-item">üìä<span id="currentPressure">- hPa</span></span><span class="meta-item" style="display:none">‚òÄÔ∏è<span id="currentUV"></span></span></div></div></div><div class="forecast-summary" id="forecastSummary"></div><div class="confidence-section"><div class="confidence-header"><span class="confidence-label">Prognoskonfidens</span><span class="confidence-value" id="confidenceValue">-</span></div><div class="confidence-bar"><div class="confidence-fill" id="confidenceFill" style="width:0%"></div></div></div></section>
            <section class="sources-section collapsible" id="sourcesSection"><h3 class="section-title section-toggle" id="sourcesToggle">Datak√§llor <span class="toggle-icon">‚ñº</span></h3><div class="sources-content" id="sourcesContent"><div class="sources-grid" id="sourcesGrid"></div></div></section>
            <section class="warnings-section" id="warningsSection" style="display:none"></section>
            <section class="air-quality-section collapsible" id="airQualitySection" style="display:none"></section>
            <section class="uv-section collapsible" id="uvSection" style="display:none"></section>
            <section class="nowcast-section collapsible" id="nowcastSection" style="display:none"></section>
            <section class="radar-section collapsible" id="radarSection" style="display:none"></section>
            <section class="hourly-section"><h3 class="section-title">Kommande timmar</h3><div class="hourly-scroll" id="hourlyScroll"></div></section>
            <section class="daily-section"><h3 class="section-title">Kommande dagar</h3><div class="daily-list" id="dailyList"></div></section>
        </div>
    </div>
    <div class="day-detail-modal" id="dayDetailModal">
        <div class="day-detail-content">
            <div class="day-detail-header">
                <h3 id="dayDetailTitle">-</h3>
                <button class="day-detail-close" id="dayDetailClose">‚úï</button>
            </div>
            <div class="day-detail-summary" id="dayDetailSummary"></div>
            <div class="day-detail-hourly" id="dayDetailHourly"></div>
        </div>
    </div>
    <div class="install-prompt" id="installPrompt"><div class="install-content"><div class="install-icon">üì≤</div><div class="install-text"><div class="install-title">Installera appen</div><div class="install-desc">L√§gg till p√• hemsk√§rmen f√∂r snabb √•tkomst</div></div></div><div class="install-actions"><button class="install-btn install-btn-secondary" id="installDismiss">Inte nu</button><button class="install-btn install-btn-primary" id="installAccept">Installera</button></div></div>
    <script src="app.js"></script>
</body>
</html>
